---
title: 并查集
date: 2025-10-06
categories: 数据结构
tags:
  - 分组
  - 并查集
  - 数据结构
---

## 并查集

并查集是一种用于管理元素所属集合的数据结构，实现为一个森林，其中每棵树表示一个集合，树中的节点表示对应集合中的元素

并查集支持：

- **查找**：查询元素所属集合
- **合并**：合并两个集合

![img](并查集/v2-cca3ddf5806a221201ed78caf1d27041_1440w.jpg)

### 初始化

初始时，每个元素为一个集合，一个指针指向自身表示**该集合由该元素代表**

![img](并查集/v2-09fa3fa35e5411444b327d9cb9a31057_1440w.jpg)

### 查询

通过给定的节点，不断沿着指针查询**集合代表**直到根节点

- **路径压缩**：当一个集合节点越来越多时，每次查询都可能要经过很长的链路，为此我们可以在每次查询时，将查询路径上所有节点的指针指向根节点，这样就压缩了查询的路径

  ![img](并查集/v2-23c367515ace6fc0603692dfd865849f_1440w.jpg)

  ![img](并查集/v2-c2f835398a3e54d8209bf5e034ac6820_1440w.jpg)

### 合并

要合并两个集合，只需将一个集合的根节点指向另一个集合的根节点即可

![img](并查集/v2-3c353bc781c7f3553079d541a9cfdc28_1440w.jpg)

在合并时，我们希望**树高较小**的集合合并到树高较大的集合，尽可能地减少树高，防止后续查询链路过长

![img](并查集/v2-d3ff42bb79a6bc751f47daf3fc70e0d9_1440w.jpg)